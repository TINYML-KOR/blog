<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Seunghyun Oh">
<meta name="dcterms.date" content="2024-03-19">
<meta name="description" content="Knowledge Distillation(KD)">

<title>TinyML KOR - ğŸ§‘â€ğŸ« Lecture 9</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">TinyML KOR</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">TinyML Study Group</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-is-knowledge-distillation" id="toc-what-is-knowledge-distillation" class="nav-link active" data-scroll-target="#what-is-knowledge-distillation">1. What is Knowledge Distillation?</a></li>
  <li><a href="#what-to-match-between-teacher-and-student-network" id="toc-what-to-match-between-teacher-and-student-network" class="nav-link" data-scroll-target="#what-to-match-between-teacher-and-student-network">2. What to match between Teacher and Student Network?</a>
  <ul class="collapse">
  <li><a href="#output-logits" id="toc-output-logits" class="nav-link" data-scroll-target="#output-logits">2.1 Output logits</a></li>
  <li><a href="#intermediate-weights" id="toc-intermediate-weights" class="nav-link" data-scroll-target="#intermediate-weights">2.2 Intermediate weights</a></li>
  <li><a href="#intermediate-features" id="toc-intermediate-features" class="nav-link" data-scroll-target="#intermediate-features">2.3 Intermediate features</a></li>
  <li><a href="#gradients" id="toc-gradients" class="nav-link" data-scroll-target="#gradients">2.4 Gradients</a></li>
  <li><a href="#sparsity-patterns" id="toc-sparsity-patterns" class="nav-link" data-scroll-target="#sparsity-patterns">2.5 Sparsity patterns</a></li>
  <li><a href="#relational-information-different-layers" id="toc-relational-information-different-layers" class="nav-link" data-scroll-target="#relational-information-different-layers">2.6.1 Relational information: Different Layers</a></li>
  <li><a href="#relational-information-different-samples" id="toc-relational-information-different-samples" class="nav-link" data-scroll-target="#relational-information-different-samples">2.6.1 Relational information: Different Samples</a></li>
  </ul></li>
  <li><a href="#self-and-online-distillation" id="toc-self-and-online-distillation" class="nav-link" data-scroll-target="#self-and-online-distillation">3. Self and Online Distillation</a>
  <ul class="collapse">
  <li><a href="#self-distillation" id="toc-self-distillation" class="nav-link" data-scroll-target="#self-distillation">3.1 Self Distillation</a></li>
  <li><a href="#online-distillation" id="toc-online-distillation" class="nav-link" data-scroll-target="#online-distillation">3.2 Online Distillation</a></li>
  <li><a href="#combined-distillation" id="toc-combined-distillation" class="nav-link" data-scroll-target="#combined-distillation">3.3 Combined Distillation</a></li>
  </ul></li>
  <li><a href="#distillation-for-different-tasks" id="toc-distillation-for-different-tasks" class="nav-link" data-scroll-target="#distillation-for-different-tasks"><strong>4. Distillation for different tasks</strong></a>
  <ul class="collapse">
  <li><a href="#object-detection" id="toc-object-detection" class="nav-link" data-scroll-target="#object-detection">4.1 Object Detection</a></li>
  <li><a href="#semantic-segmentation" id="toc-semantic-segmentation" class="nav-link" data-scroll-target="#semantic-segmentation">4.2 Semantic Segmentation</a></li>
  <li><a href="#gan" id="toc-gan" class="nav-link" data-scroll-target="#gan">4.3 GAN</a></li>
  <li><a href="#transformer" id="toc-transformer" class="nav-link" data-scroll-target="#transformer">4.4 Transformer</a></li>
  </ul></li>
  <li><a href="#network-augmentation-a-training-technique-for-tiny-machine-learning-models." id="toc-network-augmentation-a-training-technique-for-tiny-machine-learning-models." class="nav-link" data-scroll-target="#network-augmentation-a-training-technique-for-tiny-machine-learning-models.">5. Network Augmentation, <strong>a training technique for tiny machine learning models.</strong></a>
  <ul class="collapse">
  <li><a href="#network-augmentation" id="toc-network-augmentation" class="nav-link" data-scroll-target="#network-augmentation">5.2 Network Augmentation</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ğŸ§‘â€ğŸ« Lecture 9</h1>
  <div class="quarto-categories">
    <div class="quarto-category">lecture</div>
    <div class="quarto-category">knowledge distillation</div>
  </div>
  </div>

<div>
  <div class="description">
    Knowledge Distillation(KD)
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Seunghyun Oh </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 19, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<style>
p {
  line-height: 2; /* Adjust the line-height property as needed */
  text-align: justify;
  text-justify: inter-word; /* Adjust the justification mode as needed */
}

.image-container {
  text-align: center; /* Center-align the contents horizontally */
}

.centered-text {
  text-align: center; /* Center-align the text within the container */
}
</style>
<p>ì´ë²ˆ ì‹œê°„ì€ Knowledge Distillation ê¸°ë²•ì— ëŒ€í•´ì„œ ì´ì•¼ê¸° í•´ë³¼ê¹Œ í•´ìš”. ì§€ê¸ˆê¹Œì§€ <strong>ì‘ì€ í¬ê¸°ì˜ ëª¨ë¸ì„ ë§Œë“œëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ</strong> ì•Œì•„ë´¤ì§€ë§Œ, ì—¬ì „íˆ ì‘ì€ ëª¨ë¸ì€ ì„±ëŠ¥ì ìœ¼ë¡œ ë¶€ì¡±í•œ ì ì´ ë§ì£ . ì„±ëŠ¥ì„ ê°œì„ ì‹œí‚¤ëŠ” ë‹¤ë¥¸ ë°©ë²•ì— ëŒ€í•´ì„œ ê³ ë¯¼í•˜ë‹¤ê°€ <strong>â€œí¬ê¸°ê°€ í° ëª¨ë¸ì„ ì´ìš©í•´ë³´ì.â€</strong> ì—ì„œ ë‚˜ì˜¨ ì•„ì´ë””ì–´ê°€ ë°”ë¡œ Knowledge Distillation ì…ë‹ˆë‹¤.</p>
<section id="what-is-knowledge-distillation" class="level2">
<h2 class="anchored" data-anchor-id="what-is-knowledge-distillation">1. What is Knowledge Distillation?</h2>
<p>Knowledge Distillationì€ ê°„ë‹¨í•˜ê²Œ Teach Networkë¼ê³  ë¶ˆë¦¬ëŠ” í¬ê¸°ê°€ í° ëª¨ë¸ì´ ìˆì–´ìš”. ì´ Teacher Networkê°€ ë¨¼ì € Trainingì„ í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì˜¤ëŠ˜ì˜ ì£¼ì¸ê³µ <strong>Student Network</strong>ë¡œ ë¶ˆë¦¬ëŠ” í¬ê¸°ê°€ ì‘ì€ ëª¨ë¸ì´ ìˆì£ . ì´ ëª¨ë¸ì€ ë‘ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ í•™ìŠµì„ í•˜ëŠ”ë°, ì²« ë²ˆì§¸ëŠ” ê¸°ì¡´ì— í•™ìŠµí•˜ë˜ ëŒ€ë¡œ Target ë°ì´í„°ë¡œë¶€í„° í•™ìŠµì´ ìˆêµ¬ìš”. ë‹¤ë¥¸ í•œ ê°€ì§€ëŠ” <strong>Teacher Network</strong>ë¥¼ ë”°ë¼ê°€ëŠ” í•™ìŠµì´ ìˆìŠµë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Knowledge Distillation: A Survey [Gou&nbsp;et al., IJCV 2020]</figcaption>
</figure>
</div>
<ul>
<li>The goal of knowledge distillation is to align the class probability distributions from teacher and student networks.</li>
</ul>
<p>ê·¸ëŸ¼ ê¶ê¸ˆí•œ ì ì´ <strong>Teacher Networkì— ì–´ë–¤ ì ì„ ë°°ì›Œì•¼í• ê¹Œìš”?</strong> ê°•ì˜ì—ì„œëŠ” ì´ 6ê°œë¡œ Output logit, Intermediate weight, Intermediate feature, Gradient, Sparsity pattern, Relational informationìœ¼ë¡œ ë‚˜ëˆ ì„œ ì„¤ëª…í•©ë‹ˆë‹¤. ì„¤ëª…í•˜ê¸°ì— ì•ì„œì„œ ê°œë…í•˜ë‚˜ ì†Œê°œí•˜ê³  ë„˜ì–´ê°ˆê»˜ìš”.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 1.png" class="img-fluid figure-img"></p>
<figcaption>Reference. MIT-TinyML-lecture10-Knowledge-Distillation in <a href="https://efficientml.ai/">https://efficientml.ai</a></figcaption>
</figure>
</div>
<p>ë§Œì•½ ìœ„ Teacher Networkê°€ í•™ìŠµí•œ ê²°ê³¼(T=1)ë¡œ ê³ ì–‘ì´ ì‚¬ì§„ì¼ í™•ë¥  0.982, ê°•ì•„ì§€ ì‚¬ì§„ì¼ í™•ë¥ ì´ 0.017ì´ë¼ê³  í•©ì‹œë‹¤. ê·¸ëŸ¼ Student NetworkëŠ” Output logitì„ í•™ìŠµí•œë‹¤ê³  ê°€ì •í•˜ë©´, ì´ ë‘ í™•ë¥ ì„ ë”°ë¼ ê°ˆê²ë‹ˆë‹¤. í•˜ì§€ë§Œ Student Networkì— ë”°ë¼ ì´ ìˆ˜ì¹˜ê¹Œì§€ í•™ìŠµí•˜ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë•Œ â€œ<strong>Temperature(T)</strong>â€ì´ë¼ëŠ” ê°œë…ì„ ë“¤ì—¬ì™€ Teacher Networkì˜ Catê³¼ Dogì— ëŒ€í•œ í™•ë¥ ì„ ì¢€ ë” Smoothí•˜ê²Œ ë§Œë“¤ì£ .</p>
<p><span class="math display">\[
p(z_i,T) = \dfrac{exp(z_j/T)}{\sum_j exp(z_j/T)}
\]</span></p>
<p>ì‹ìœ¼ë¡œ ì“°ë©´ ìœ„ì™€ ê°™ì´ ë í…ë°, <strong>ë³´í†µì€ 1ë¡œ ë‘ê³ </strong> í•œë‹¤ê³  ê°•ì˜ì—ì„œ ì–¸ê¸‰í•©ë‹ˆë‹¤. ì™œ ì„¤ëª…í–ˆëƒêµ¬ìš”? í˜¹ì‹œë‚˜ ê°œë…ì´ ë‚˜ì˜¤ë©´ ì´í•´í•˜ì‹œê¸° í¸í•˜ì‹œë¼êµ¬ìš”ğŸ™‚&nbsp;ê·¸ëŸ¼, <strong>Teacher Networkì—ì„œ ì–´ë–¤ ë¶€ë¶„ì„ Student Networkì— í•™ìŠµì‹œí‚¬ì§€</strong> ì•Œì•„ë³´ì‹œì£ .</p>
</section>
<section id="what-to-match-between-teacher-and-student-network" class="level2">
<h2 class="anchored" data-anchor-id="what-to-match-between-teacher-and-student-network">2. What to match between Teacher and Student Network?</h2>
<section id="output-logits" class="level3">
<h3 class="anchored" data-anchor-id="output-logits">2.1 Output logits</h3>
<p>ì²« ë²ˆì§¸ëŠ” Output logitì…ë‹ˆë‹¤. lossë¡œëŠ” ëŒ€í‘œì ìœ¼ë¡œ Cross entropy lossì™€ L2 lossê°€ ìˆê² ì£ .</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 2.png" class="img-fluid figure-img"></p>
<figcaption>Reference. MIT-TinyML-lecture10-Knowledge-Distillation in <a href="https://efficientml.ai/">https://efficientml.ai</a></figcaption>
</figure>
</div>
</section>
<section id="intermediate-weights" class="level3">
<h3 class="anchored" data-anchor-id="intermediate-weights">2.2 Intermediate weights</h3>
<p>ë‘ ë²ˆì§¸ëŠ” Layerë§ˆë‹¤ Weightì…ë‹ˆë‹¤. í•˜ì§€ë§Œ <strong>Student Modelì€ Weight dimesionì´ ë‹¤ë¥¼ ìˆ˜ ë°–ì— ì—†ëŠ”ë°</strong>, ê·¸ëŸ¼ Linear Transformationì„ ì´ìš©í•´ì„œ Dimensionì„ ë§ì¶° í•™ìŠµí•˜ë©´ ë˜ê² ë„¤ìš”.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 3.png" class="img-fluid figure-img"></p>
<figcaption>Reference. MIT-TinyML-lecture10-Knowledge-Distillation in <a href="https://efficientml.ai/">https://efficientml.ai</a></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 4.png" class="img-fluid figure-img"></p>
<figcaption>Reference. MIT-TinyML-lecture10-Knowledge-Distillation in <a href="https://efficientml.ai/">https://efficientml.ai</a></figcaption>
</figure>
</div>
<p>ìŠ¤í„°ë”” ì¤‘ì— ë‚˜ì˜¨ ì§ˆë¬¸ì´ â€œê·¸ëŸ¼ Student Networkì—ì„œ ì¶”ê°€ì ì¸ ë ˆì´ì–´ê°€ ìƒê¸°ëŠ”ë°, ì‘ê²Œ ë§Œë“œëŠ” ì˜ë¯¸ê°€ ì—†ì§€ ì•ŠëŠëƒ?â€ ì˜€ìŠµë‹ˆë‹¤. ì œ ìƒê°ì€ Weight Dimensionì„ ë§ì¶”ê¸° ìœ„í•œ Linear Transformationì„ ìœ„í•œ ë ˆì´ì–´ëŠ” ì¶”ë¡ ì‹œ ì‚¬ìš©í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìœ¼ë‹ˆ, Student Networkì˜ ì„±ëŠ¥ì„ ë†’ì´ê¸° ë” ì œê²©ì•„ë‹ê¹Œìš”? ë§ˆì¹˜ ì¶”ë¡  ë•Œ í•„ìš”í•œ ë¶€í’ˆë§Œ ì¡°ë¦½í•˜ë“¯ ë§ì´ì£ .</p>
</section>
<section id="intermediate-features" class="level3">
<h3 class="anchored" data-anchor-id="intermediate-features">2.3 Intermediate features</h3>
<p>ì„¸ ë²ˆì§¸ëŠ” Feature ì…ë‹ˆë‹¤. ì´ì „ ê²½ìš°ê°€ Weightë¼ê³  í•˜ë©´, ì´ë²ˆì€ Layerì˜ Outputì…ë‹ˆë‹¤. Teach Networkê³¼ Student Networkì˜ Featureë¥¼ ê°™ê²Œ í•™ìŠµì‹œí‚¤ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ê°€ì§€ê°€ ìˆëŠ”ë°, ì—¬ê¸°ì„œëŠ” Cosine of angleë¡œ í•™ìŠµì„ ì‹œí‚¤ëŠ” ë°©ë²•(<a href="https://arxiv.org/pdf/1707.01219.pdf">Like What You Like: Knowledge Distill via Neuron Selectivity Transfer [Huang and Wang, arXiv 2017]</a>) ê³¼ Dimensionì„ ì¤„ì—¬ì„œ í•™ìŠµì„ ì‹œí‚¤ëŠ” ë°©ë²•(<a href="https://arxiv.org/pdf/1802.04977.pdf">Paraphrasing Complex Network: Network Compression via Factor Transfer [Kim&nbsp;<em>et al.</em>, NeurIPS 2018]</a>)ì„ ì†Œê°œí•©ë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 5.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Like What You Like: Knowledge Distill via Neuron Selectivity Transfer [Huang and Wang, arXiv 2017]</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 6.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Paraphrasing Complex Network: Network Compression via Factor Transfer [Kim&nbsp;<em>et al.</em>, NeurIPS 2018]</figcaption>
</figure>
</div>
<ul>
<li>The paraphraser shrinks the output teacher feature map from m dimensions to m x k dimensions (called <strong>factor</strong> typically k=0.5) and then expands the dimensionality back to m.</li>
<li>The output of paraphraser is supervised with a reconstruction loss against the original m-dimensional output.</li>
<li>Student uses one layer of MLP to obtain a <strong>factor</strong> with the same dimensionality of m x k.</li>
<li>FT minimizes the distance between teacher and student factors.</li>
</ul>
</section>
<section id="gradients" class="level3">
<h3 class="anchored" data-anchor-id="gradients">2.4 Gradients</h3>
<p>ë„¤ ë²ˆì§¸ëŠ” Gradient ì…ë‹ˆë‹¤. Gradientë¥¼ ì‹œê°ì ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆëŠ” ë°©ë²•ì—ëŠ” Attention Mapì´ ìˆëŠ”ë°ìš”, ì´ Attention Mapì€ ì´ë¯¸ì§€ì—ì„œ íŠ¹ì§•ì ì¸ ë¶€ë¶„ì„ ì¡ì•„ë‚¼ ìˆ˜ ìˆì£ .</p>
<ul>
<li>Reference: Paying More Attention to Attention: Improving the Performance of Convolutional Neural Networks via Attention Transfer [Zagoruyko and Komodakis, ICLR 2017]</li>
<li>Gradients of feature maps are used to characterize attention of DNNs</li>
<li>The attention of a CNN feature map <span class="math inline">\(x\)</span> is defined as <span class="math inline">\(\dfrac{\partial L}{\partial x}\)</span>, where <span class="math inline">\(L\)</span> is the learning objective.</li>
<li>Intuition: If <span class="math inline">\(\dfrac{\partial L}{\partial x_{i,j}}\)</span> is large, a small perturbation at <span class="math inline">\(i,j\)</span> will significantly impact the final output. As a result, the network is putting more attention on position <span class="math inline">\(i, j\)</span></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 7.png" class="img-fluid figure-img"></p>
<figcaption>Reference. MIT-TinyML-lecture10-Knowledge-Distillation in <a href="https://efficientml.ai/">https://efficientml.ai</a></figcaption>
</figure>
</div>
<p>ì•„ë˜ ê·¸ë¦¼ì€ <strong>â€œAttention Mapì´ ëª¨ë¸ì˜ ì„±ëŠ¥ì´ ë†’ë‹¤ë©´ ë¹„ìŠ·í•œ íŒ¨í„´ìœ¼ë¡œ ë‚˜ì˜¨ë‹¤.â€</strong> ëŠ” ì˜ˆì‹œë¡œ ë‚˜ì˜µë‹ˆë‹¤. Resnet34ì™€ ResNet101ì˜ Attention Mapì€ ìœ ì‚¬í•˜ê²Œ ë³´ì´ëŠ” ë°˜ë©´ NINì¸ ê²½ìš°ëŠ” ë§ì´ ë‹¤ë¥¸ ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<ul>
<li><p>Performant models have similar attention maps</p>
<p>Attention makes of performant ImageNet models (ResNets) are indeed similar to each other, but the less performant model(NIN) has quite different attention maps</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 8.png" class="img-fluid figure-img"></p>
<figcaption>Reference. MIT-TinyML-lecture10-Knowledge-Distillation in <a href="https://efficientml.ai/">https://efficientml.ai</a></figcaption>
</figure>
</div></li>
</ul>
</section>
<section id="sparsity-patterns" class="level3">
<h3 class="anchored" data-anchor-id="sparsity-patterns">2.5 Sparsity patterns</h3>
<p>ë‹¤ì„¯ ë²ˆì§¸ëŠ” Sparsity Pattern ì…ë‹ˆë‹¤. Layerë§ˆë‹¤ Output Acitivationì„ ê°™ê²Œ ë§Œë“œëŠ” ë°©ë²•ì¸ë°, Intermediate Featureì™€ ìœ ì‚¬í•˜ê²Œ ë³´ì´ë„¤ìš”.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 9.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Knowledge Transfer via Distillation of Activation Boundaries Formed by Hidden Neurons [Heo&nbsp;<em>et al.</em>, AAAI 2019]</figcaption>
</figure>
</div>
<ul>
<li><p>Intuition: the teacher and student networks should have similar sparsity patterns after the ReLU activation. A neuron is activated after ReLU if its value is larger than 0, denoted by the indicator function <span class="math inline">\(\rho(x) = 1 [x&gt;0]\)</span>.</p></li>
<li><p>We want to minimize <span class="math inline">\(\mathscr{L}(I) = \lvert\lvert \rho(T(I))-\rho(S(I)) \lvert\lvert_1\)</span>, where <span class="math inline">\(S\)</span> and <span class="math inline">\(T\)</span> corresponds to student and teacher networks, respectively</p></li>
</ul>
</section>
<section id="relational-information-different-layers" class="level3">
<h3 class="anchored" data-anchor-id="relational-information-different-layers">2.6.1 Relational information: Different Layers</h3>
<p>ë§ˆì§€ë§‰ìœ¼ë¡œ ëª¨ë¸ë‚´ì—ì„œ ë‚˜ì˜¤ëŠ” í…ì„œì˜ ìƒí˜¸ ì—°ê´€ì„±ì— ëŒ€í•´ì„œë„ ê°™ê²Œ í•  ìˆ˜ ìˆë‹¤ëŠ” ë°©ë²• ë‘ ê°€ì§€ê°€ ë‚˜ì˜µë‹ˆë‹¤. ì²« ë²ˆì§¸ëŠ” ê° ë ˆì´ì–´ì˜ ì…ë ¥, ì¶œë ¥ í…ì„œë¥¼ Inner product í•˜ê²Œ ë˜ë©´ í•˜ë‚˜ì˜ Matrixë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ”ë°, ì´ Matrixë¥¼ ê°™ê²Œ í•™ìŠµì‹œí‚¨ë‹¤ëŠ” ì•„ì´ë””ì–´ì£ .</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/KD-related-info.gif" class="img-fluid figure-img"></p>
<figcaption>Reference: A Gift from Knowledge Distillation: Fast Optimization, Network Minimization and Transfer Learning [Yim&nbsp;<em>et al.</em>, CVPR 2017]</figcaption>
</figure>
</div>
<ol type="1">
<li><p>Use <strong>inner product to extract relational information</strong> (a matrix of shape <span class="math inline">\(C_{in} \times C_{out}\)</span>, reduction on the spatial dimensions) for both student and teacher networks. *Note: the student and teacher networks only differ in number of layers, not number of channels</p></li>
<li><p>Then match the resulting <strong>dot products between teacher and student networks</strong> <span class="math inline">\((G_1^T, G_1^S)\)</span></p></li>
</ol>
</section>
<section id="relational-information-different-samples" class="level3">
<h3 class="anchored" data-anchor-id="relational-information-different-samples">2.6.1 Relational information: Different Samples</h3>
<p>ë‘ ë²ˆì§¸ëŠ” ì´ì „ê¹Œì§€ ì €í¬ëŠ” í•™ìŠµë°ì´í„° í•˜ë‚˜í•˜ë‚˜ë§ˆë‹¤ ë‚˜ì˜¤ëŠ” ê²°ê³¼ë¥¼ Teachì™€ Studentë¥¼ ê°™ê²Œë” í•™ìŠµì‹œì¼°ëŠ”ë°, ì´ë²ˆì—” <strong>ì—¬ëŸ¬ í•™ìŠµë°ì´í„°ì—ì„œ ë‚˜ì˜¨ ì—¬ëŸ¬ Outputì„ í•˜ë‚˜ì˜ Matrix í˜•íƒœ</strong>ë¡œ ë‹®ê²Œ ë§Œë“œëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p>
<ul>
<li><strong>Conventional KD</strong> focuses on matching features / logins <strong>for one input</strong>. <strong>Relation KD</strong> looks at the relations between intermediate features <strong>from multiple inputs.</strong></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 10.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Relational Knowledge Distillation [Park&nbsp;<em>et al.</em>, CVPR 2019]</figcaption>
</figure>
</div>
<ul>
<li><p>Relation between different samples</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 11.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Relational Knowledge Distillation [Park&nbsp;<em>et al.</em>, CVPR 2019]</figcaption>
</figure>
</div></li>
</ul>
<p>ì§€ê¸ˆê¹Œì§€ Student Networkê°€ Teacher Networkì˜ ì–´ë–¤ Outputì„ ê°€ì§€ê³  í•™ìŠµì‹œí‚¬ì§€ì— ëŒ€í•´ì„œ ì•Œì•„ë´¤ìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ì €í¬ê°€ TinyMLì„ í•˜ëŠ” ëª©ì ì€ ì‚¬ì‹¤ <strong>â€œë” ì‘ì€ ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚¬ìš©í•´ë³´ì.â€</strong> ì´ì§€ ì•Šì•˜ë‚˜ìš”? ì¦‰, Teacher Networkì—†ì´ Student Networkë§Œìœ¼ë¡œëŠ” í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ì—†ì„ê¹Œìš”? ì´ëŸ° ìƒê°ì—ì„œ ë‚˜ì˜¨ ì•„ì´ë””ì–´ê°€ Self and Online Distillation ì…ë‹ˆë‹¤.</p>
</section>
</section>
<section id="self-and-online-distillation" class="level2">
<h2 class="anchored" data-anchor-id="self-and-online-distillation">3. Self and Online Distillation</h2>
<ul>
<li>What is the disadvantage of fixed large teachers? Does it have to be the case that we need a fixed large teacher in KD?</li>
</ul>
<section id="self-distillation" class="level3">
<h3 class="anchored" data-anchor-id="self-distillation">3.1 Self Distillation</h3>
<p>ì²« ë²ˆì§¸ Self Distillationì€ êµ¬ì¡°ê°€ ê°™ì€ ë„¤íŠ¸ì›Œí¬ë¥¼ ê³„ì†í•´ì„œ ë³µì‚¬í•´ ë‚˜ê°‘ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ì„œ ì´ì „ì— í•™ìŠµí•œ ë„¤íŠ¸ì›Œí¬ë¡œ ë¶€í„°ë„ ë³µì‚¬ëœ ë„¤íŠ¸ì›Œí¬ê°€ í•™ìŠµí•  ìˆ˜ ìˆë„ë¡ í•˜ë©°, kê°œ ë§Œí¼ ë³µì‚¬í•˜ë©° í•™ìŠµí•œ í›„ì— ìµœì¢… Outputìœ¼ë¡œëŠ” ë³µì‚¬í•œ ë„¤íŠ¸ì›Œí¬ë“¤ì˜ Outputì„ Ensembleí•œ ê²°ê³¼ë¥¼ ì´ìš©í•˜ì£ . ì—¬ê¸°ì„œ AccuracyëŠ” kë²ˆì§¸ë¡œ ê°ˆìˆ˜ë¡ ëŠ˜ì–´ë‚˜ê² ì£ ?</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 12.png" class="img-fluid figure-img"></p>
<figcaption>Born-Again Neural Networks [Furlanello et al., ICML 2018]</figcaption>
</figure>
</div>
<ul>
<li><p>Born-Again Networks generalizes defensive distillation by <strong>adding iterative training states</strong> and <strong>using both classification objective and distillation objective</strong> in subsequent stages.</p></li>
<li><p>Network architecture <span class="math inline">\(T = S_1=S_2=\dots=S_k\)</span></p></li>
<li><p>Network accuracy <span class="math inline">\(T &lt; S_1 &lt; S_2 &lt; \dots &lt; S_k\)</span></p></li>
<li><p>Can alteratively ensemble <span class="math inline">\(T,S_1, S_2, \dots, S_k\)</span> to get even better performance</p></li>
</ul>
</section>
<section id="online-distillation" class="level3">
<h3 class="anchored" data-anchor-id="online-distillation">3.2 Online Distillation</h3>
<p>ë‘ ë²ˆì§¸ëŠ” Online Distillationì¸ë°, ì—¬ê¸° ì•„ì´ë””ì–´ëŠ” <strong>â€œê°™ì€ ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°ë¥¼ ì“°ì.â€</strong> ì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  Teacher networkê³¼ Student networkëŠ” ì²˜ìŒë¶€íƒ€ ê°™ì´ í•™ìŠµí•˜ëŠ”ë°, Lossì— í•œ ê°€ì§€ í•­ì´ ì¶”ê°€ë˜ì£ . ë°”ë¡œ â€œKL Divergenceâ€ ì…ë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 13.png" class="img-fluid figure-img"></p>
<figcaption>Reference: Deep Mutual Learning [Zhang&nbsp;et al., CVPR 2018]</figcaption>
</figure>
</div>
<ul>
<li><p>Idea: for both teach and student networks, we want to add a distillation objective that minimizes the output distribution of the other party.</p></li>
<li><p><span class="math inline">\(\mathscr{L}(S) = CrossEntropy(S(I), y)+KL(S(I), T(I))\)</span></p></li>
<li><p><span class="math inline">\(\mathscr{L}(T) = CrossEntropy(T(I), y)+KL(S(I), T(I))\)</span></p></li>
<li><p>It is not necessary to retrain <span class="math inline">\(T\)</span> and <span class="math inline">\(S=T\)</span> is allowed</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 14.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Deep Mutual Learning [Zhang&nbsp;et al., CVPR 2018]</figcaption>
</figure>
</div></li>
</ul>
</section>
<section id="combined-distillation" class="level3">
<h3 class="anchored" data-anchor-id="combined-distillation">3.3 Combined Distillation</h3>
<p>ë§ˆì§€ë§‰ì€ Self ì™€ Online Distillationì„ í•©ì¹œ ì—°êµ¬ë“¤ì„ ì†Œê°œí• ê²Œìš”.</p>
<p>ì²« ë²ˆì§¸ëŠ” On-the-Fly Native Ensemble ì…ë‹ˆë‹¤. êµ¬ì¡°ë¥¼ ë³´ì‹œë©´ Branch ë§ˆë‹¤ ëª¨ë¸ì˜ êµ¬ì¡°ë„ ë™ì¼í•˜ê²Œ Branch 0, Branch 1, â€¦ , Branch m ìœ¼ë¡œ ë‚˜ë‰˜ëŠ” ê²Œ Self Distillationë¥¼ ë³´ëŠ” ë“¯í•˜ì£ . ê·¸ë¦¬ê³  ê° Branchë¥¼ í•™ìŠµì‹œ ë™ì‹œì— ì§„í–‰í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì´ë„¤ìš”.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 15.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Knowledge Distillation by On-the-Fly Native Ensemble [Lan et al., NeurlPS 2018]</figcaption>
</figure>
</div>
<ul>
<li><p>Idea: generating <strong>multiple</strong> output probability distributions and <strong>ensemble</strong> them as the target distribution for knowledge distillation.</p></li>
<li><p>Similar to DML(Deep Mutual Learning), ONE allows the teacher model to be exactly the same as the student model, and it does not require retraining the teach network first. It is also not necessary to train two models as in DML.</p></li>
<li><p>Result</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 16.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Knowledge Distillation by On-the-Fly Native Ensemble [Lan et al., NeurlPS 2018]</figcaption>
</figure>
</div></li>
</ul>
<p>ë‘ ë²ˆì§¸ ì—°êµ¬ëŠ” Be Your Own Teacher ë¼ëŠ” ì—°êµ¬ì¸ë°, ì—¬ê¸°ì„œëŠ” ê° ë ˆì´ì–´ë§ˆë‹¤ ë‚˜ì˜¨ Feature mapì— ì¶”ê°€ì ì¸ ë ˆì´ì–´ë¥¼ ë¶™ì—¬ì„œ Self Distillationì˜ ë°©ë²•ì„ ì´ìš©í•©ë‹ˆë‹¤. Lossë¡œëŠ” Cross entropy(Output Logit), ì¶”ê°€ì ìœ¼ë¡œ ë¶™ì—¬ì„œ ë§Œë“  ê° ëª¨ë¸ë§ˆë‹¤ KL Divergence, ê·¸ë¦¬ê³  intermediate featureë¥¼ ì‚¬ìš©í•˜ë„¤ìš”. í¥ë¯¸ë¡œì› ë˜ ì ì€ ì²« ë²ˆì§¸, ë‘ ë²ˆì§¸ ë ˆì´ì–´ì—ì„œëŠ” ì„±ëŠ¥ì´ ê±°ì˜ ë‚˜ì˜¤ì§€ ì•Šì„ ê²ƒ ê°™ì•˜ëŠ”ë° ë‘ ë²ˆì§¸ ë ˆì´ì–´ë¶€í„°ëŠ” Ensembleê¹Œì§€ ì–´ëŠì •ë„ ì„±ëŠ¥ì´ ë‚˜ì˜¤ëŠ” ê²ƒì„ ê²°ê³¼ì—ì„œ ë³¼ ìˆ˜ ìˆì–´ìš”.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 17.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Be Your Own Teacher: Improve the Performance of Convolutional Neural Networks via Self Distillation [Zhang&nbsp;<em>et al.</em>, ICCV 2019]</figcaption>
</figure>
</div>
<ul>
<li><p>Use deeper layers to distill shallower layers.</p></li>
<li><p>Intuition: Labels at later stages are more reliable, so the authors use them to supervise the predictions from the previous stages.</p></li>
<li><p>Result</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 18.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Be Your Own Teacher: Improve the Performance of Convolutional Neural Networks via Self Distillation [Zhang&nbsp;<em>et al.</em>, ICCV 2019]</figcaption>
</figure>
</div></li>
</ul>
</section>
</section>
<section id="distillation-for-different-tasks" class="level2">
<h2 class="anchored" data-anchor-id="distillation-for-different-tasks"><strong>4. Distillation for different tasks</strong></h2>
<p>ì´ë ‡ê²Œ ì•Œì•„ë³¸ Knowledge Distillationì€ ì–´ë–¤ Applicationì— ì‚¬ìš©ë  ìˆ˜ ìˆì„ê¹Œìš”? ê°•ì˜ëŠ” Object Detection, Semantic Segmentation, GAN, Transformer ëª¨ë¸ë¡œ ë‚˜ëˆ ì„œ ì´ì•¼ê¸°í•©ë‹ˆë‹¤. ê° ë¶€ë¶„ë§ˆë‹¤ ì–´ë–¤ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ”ì§€ í˜¹ì€ ì–´ë–¤ ì•„ì´ë””ì–´ë¥¼ ì‚¬ìš©í–ˆëŠ”ì§€ë§Œ ì§šê³  ë„˜ì–´ê°€ë³¼ê²Œìš”(ìì„¸í•œ ë‚´ìš©ì€ ë…¼ë¬¸ì„ ì°¸ì¡°!).</p>
<section id="object-detection" class="level3">
<h3 class="anchored" data-anchor-id="object-detection">4.1 Object Detection</h3>
<p>Object Detectionì€ ì„¸ ê°€ì§€ë¡œ í•´ê²°í•´ì•¼í•  ë¬¸ì œê°€ ëŠ˜ì–´ë‚¬ìŠµë‹ˆë‹¤. í•˜ë‚˜ëŠ” Classification, ê·¸ë™ì•ˆ í•´ì™”ë˜ ë¶€ë¶„ì´êµ¬ìš”, ë‹¤ë¥¸ ë‘ ê°œëŠ” Backgroundì™€ Foregroundì„ êµ¬ë¶„í•˜ëŠ” ê²ƒê³¼ Bounding block ë¬¸ì œ ì…ë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/object-detection-KD.gif" class="img-fluid figure-img"></p>
<figcaption>Reference. Object Detection: Learning Efficient Object Detection Models with Knowledge Distillation [Chen&nbsp;<em>et al.</em>, NeurIPS 2017]</figcaption>
</figure>
</div>
<p><a href="https://proceedings.neurips.cc/paper_files/paper/2017/file/e1e32e235eee1f970470a3a6658dfdd5-Paper.pdf">ì´ ì—°êµ¬</a>ëŠ” Classifcationê³¼ Background, Foreground ë¬¸ì œë¥¼ ìœ„í•´ ì„¸ ê°€ì§€ Lossë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. í•˜ë‚˜ëŠ” Feature, ê·¸ë¦¬ê³  Output Logitì—ì„œ Background, Foregroundë¥¼ ê°ê° ë‹¤ë¥¸ Weightë¥¼ ì¤€ Cross Entropy, ë§ˆì§€ë§‰ì€ Bounded í•œ Regression Loss ì…ë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 19.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Localization: Localization Distillation for Dense Object Detection [Zheng&nbsp;<em>et al.</em>, CVPR 2022]</figcaption>
</figure>
</div>
<p>ê·¸ëŸ¼ Bounding block ì€ ì–´ë–»ê²Œ í•´ê²°í• ê¹Œìš”? <a href="https://arxiv.org/pdf/2102.12252.pdf">ì´ ë…¼ë¬¸</a>ì—ì„œëŠ” Xì¶•ê³¼ Yì¶•ìœ¼ë¡œ 6ê°œë¡œ ë‚˜ëˆ ì§„ êµ¬ì—­ì—ì„œ ë‘ ì ìœ¼ë¡œ bounding blockì„ ì¡ìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ ì¡ì€ Bounding blockì˜ ë¶„í¬ë¥¼ Student Networkê°€ í•™ìŠµí•˜ëŠ” ê²ë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Lecture_09-Knowledge-Distillation_(4).jpg" class="img-fluid figure-img"></p>
<figcaption>Reference. Localization: Localization Distillation for Dense Object Detection [Zheng&nbsp;<em>et al.</em>, CVPR 2022]</figcaption>
</figure>
</div>
</section>
<section id="semantic-segmentation" class="level3">
<h3 class="anchored" data-anchor-id="semantic-segmentation">4.2 Semantic Segmentation</h3>
<p>ë‘ ë²ˆì§¸ Taskì¸ Semantic Segmentationì—ì„œëŠ” Featureì™€ Output Logitì—ì„œ <strong>Pixel ë‹¨ìœ„ë¡œ Loss</strong>ë¥¼ êµ¬í•œ ë‹¤ëŠ” ì , ê·¸ë¦¬ê³  <strong>Discriminator ëª¨ë¸</strong>ì„ ê°€ì§€ê³  í•™ìŠµì„ ì‹œí‚¨ë‹¤ëŠ” ì ì´ ë”í•´ì¡ŒìŠµë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 20.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Semantic Segmentation: Structured Knowledge Distillation for Semantic Segmentation [Liu&nbsp;<em>et al.</em>, CVPR 2019]</figcaption>
</figure>
</div>
</section>
<section id="gan" class="level3">
<h3 class="anchored" data-anchor-id="gan">4.3 GAN</h3>
<p>ì„¸ë²ˆì§¸ TaskëŠ” GAN ì…ë‹ˆë‹¤. ë§¤ Task ë§ˆë‹¤ feature mapì„ KD-lossë¡œ ê°€ì ¸ê°€ê³  ê¸°ì¡´ì— Output Logitì€ ë™ì¼í•˜ê²Œ ê°€ì ¸ê°€ë„¤ìš”. ì¶”ê°€ë¡œ í•´ë‹¹ ì—°êµ¬ì—ì„œëŠ” ê° ë ˆì´ì–´ë§ˆë‹¤ ì±„ë„ ìˆ˜ ì¤‘ ì„±ëŠ¥ì´ ê°€ì¥ ì¢‹ì€ ì¼€ì´ìŠ¤ì— í•œí•´ Fine-Tuningì„ ì§„í–‰í•œë‹¤ëŠ” ì ì´ ìˆìŠµë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/GAN-KD.gif" class="img-fluid figure-img"></p>
<figcaption>Reference. GAN: GAN Compression: Efficient Architectures for Interactive Conditional GANs [Li&nbsp;<em>et al.</em>, CVPR 2020]</figcaption>
</figure>
</div>
</section>
<section id="transformer" class="level3">
<h3 class="anchored" data-anchor-id="transformer">4.4 Transformer</h3>
<p>ë§ˆì§€ë§‰ì€ Transformer ëª¨ë¸ì—ì„œ Knowledge Distillation ì…ë‹ˆë‹¤. TransformerëŠ” Feature Map, Attention Mapì„ ì•ˆ ë³¼ ìˆ˜ê°€ ì—†ëŠ”ë°ìš”, ì•„ë˜ ê·¸ë¦¼ì—ì„œ ë³´ë©´ attention transferë¥¼ í•˜ê³  í•˜ì§€ ì•Šì€ ê²½ìš°í•˜ê³  í™•ì‹¤íˆ Teacherì™€ Attention mapê°€ ë¹„êµê°€ ë˜ë„¤ìš”.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Transformer-KD.gif" class="img-fluid figure-img"></p>
<figcaption>Refernece. NLP: MobileBERT: a Compact Task-Agnostic BERT for Resource-Limited Devices [Sun&nbsp;<em>et al.</em>, ACL 2020]</figcaption>
</figure>
</div>
</section>
</section>
<section id="network-augmentation-a-training-technique-for-tiny-machine-learning-models." class="level2">
<h2 class="anchored" data-anchor-id="network-augmentation-a-training-technique-for-tiny-machine-learning-models.">5. Network Augmentation, <strong>a training technique for tiny machine learning models.</strong></h2>
<p>ì§€ê¸ˆê¹Œì§€ Taskì— ëŒ€í•´ì„œ ì‚´í´ë´¤ëŠ”ë°ìš”, ê·¸ëŸ¼ Tiny Modelë„ overfitting ë¬¸ì œê°€ ìˆì§€ ì•Šì„ê¹Œìš”? ê·¸ë ˆì„œ overfittingì„ í•´ê²°í•˜ëŠ” ë°©ë²•ì—ëŠ” Data Augmentationì´ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ê·¸ë¦¼ ì²˜ëŸ¼ Cutoff, Mixup, AutoAugment, Dropoutê³¼ ê°™ì€ ë°©ë²•ë“¤ì´ ìˆìŠµë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 21.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Data Augmentation(AutoAugment: Learning Augmentation Policies from Data [Cubuk&nbsp;<em>et al.</em>, CVPR 2019])</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 22.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Dropout(DropBlock: A regularization method for convolutional networks [Ghiasi&nbsp;<em>et al.</em>, NeurIPS 2018])</figcaption>
</figure>
</div>
<p>í•˜ì§€ë§Œ Data Augmentationì„ ì ìš©í•œ Tiny Modelì˜ ì„±ëŠ¥ì„ ë³´ì‹œë©´ ì ìš©í•˜ëŠ” ë°©ë²•ë§ˆë‹¤ ë–¨ì–´ì§€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì—¬ê¸°ì„œ ì œì•ˆí•œ ì•„ì´ë””ì–´ê°€ â€œ<strong>Network Augmentation</strong>â€ ì…ë‹ˆë‹¤.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 23.png" class="img-fluid figure-img"></p>
<figcaption>Reference. MIT-TinyML-lecture10-Knowledge-Distillation in <a href="https://efficientml.ai/">https://efficientml.ai</a></figcaption>
</figure>
</div>
<ul>
<li>Tiny Neural Network lacks capacity! â†’ NetAug</li>
</ul>
<section id="network-augmentation" class="level3">
<h3 class="anchored" data-anchor-id="network-augmentation">5.2 Network Augmentation</h3>
<p>Network Augmentationì€ ê¸°ì¡´ì— ë””ìì¸í•œ ëª¨ë¸ì„ ê°€ì§€ê³  í•™ìŠµì„ ì‹œí‚¨ í›„, ì› ëª¨ë¸ê³¼ <strong>ê° ë ˆì´ì–´ë§ˆë‹¤ íŒŒë¼ë¯¸í„°ë¥¼ ë³€ê²½í•œ ëª¨ë¸ì„ í•¨ê»˜ ì¬í•™ìŠµì„ ì‹œí‚¤ëŠ” ë°©ë²•</strong>ì…ë‹ˆë‹¤. íŒŒë¼ë¯¸í„°ë¥¼ ë³€ê²½í•˜ëŠ” ëª¨ë¸ê°™ì€ ê²½ìš° <a href="https://tinyml-kor.github.io/blog/posts/labs/lab03.html">ì´ì „ì‹œê°„ ì‹¤ìŠµ</a>ì— ìˆìœ¼ë‹ˆ ê¶ê¸ˆí•˜ì‹œë©´ ì°¸ê³ í•´ì£¼ì„¸ìš”. ì‹¤í—˜ê²°ê³¼ëŠ” 1.3 ~ 1.8 % Tiny ëª¨ë¸ì´ ì„±ëŠ¥ ê°œì„ ì´ ì´ë¤„ì§„ ê²ƒì„ ë³¼ ìˆ˜ ìˆì–´ìš”. ì—¬ê¸°ì„œ ì› ëª¨ë¸(ResNet50)ì´ Evaluationì—ì„œëŠ” ì´ë¯¸ ê°€ì§„ ë°ì´í„°ë¡œ ëª¨ë¸ì„ ì¶©ë¶„íˆ í›ˆë ¨ì‹œì¼°ê¸° ë•Œë¬¸ì— ë”ì´ìƒ ëŠ˜ì–´ë‚˜ì§€ ì•ŠëŠ” ê²ƒë„ í™•ì¸í•  ìˆ˜ ìˆê² ë„¤ìš”.</p>
<ul>
<li><p>Training Process</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 24.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Network Augmentation for Tiny Deep Learning [Cai&nbsp;<em>et al.</em>, ICLR 2022]</figcaption>
</figure>
</div>
<p><span class="math display">\[
  \mathscr{L}_{aug} = \mathscr{L}(W_{base}) + \alpha \mathscr{L}([W_{base}, W_{aug}])
  \]</span></p>
<ul>
<li><span class="math inline">\(\mathscr{L}_{aug}\)</span> = base supervision + <span class="math inline">\(\alpha \cdot\)</span>auxiliary supervision</li>
</ul></li>
<li><p>Learning Curve</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 25.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Network Augmentation for Tiny Deep Learning [Cai&nbsp;<em>et al.</em>, ICLR 2022]</figcaption>
</figure>
</div></li>
<li><p>Result</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 26.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Network Augmentation for Tiny Deep Learning [Cai&nbsp;<em>et al.</em>, ICLR 2022]</figcaption>
</figure>
</div></li>
<li><p>Result for Transfer Learning</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 27.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Network Augmentation for Tiny Deep Learning [Cai&nbsp;<em>et al.</em>, ICLR 2022]</figcaption>
</figure>
</div></li>
</ul>
<p>ì§€ê¸ˆê¹Œì§€ Knowledge Distilationì˜ ê¸°ë²•ë“¤ ê·¸ë¦¬ê³  ì´ë¥¼ ì´ìš©í•œ Appllcationì— ëŒ€í•´ì„œ ë‹¤ë¤„ë´¤ìŠµë‹ˆë‹¤. ë‹¤ìŒ ì‹œê°„ì—ëŠ” TinyEngineì„ ìœ„í•œ ìµœì í™” ê¸°ë²•ìœ¼ë¡œ ë‹¤ì‹œ ì°¾ì•„ì˜¬ê²Œìš” ğŸ™‚</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="TINYML-KOR/blog" data-repo-id="R_kgDOLC9iGA" data-category="General" data-category-id="DIC_kwDOLC9iGM4Cc7eP" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->




</body></html>