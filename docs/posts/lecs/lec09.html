<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Seunghyun Oh">
<meta name="dcterms.date" content="2024-03-19">
<meta name="description" content="Knowledge Distillation(KD)">

<title>TinyML KOR - üßë‚Äçüè´ Lecture 9</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">TinyML KOR</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">TinyML Study Group</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-is-knowledge-distillation" id="toc-what-is-knowledge-distillation" class="nav-link active" data-scroll-target="#what-is-knowledge-distillation">1. What is Knowledge Distillation?</a></li>
  <li><a href="#what-to-match-between-teacher-and-student-network" id="toc-what-to-match-between-teacher-and-student-network" class="nav-link" data-scroll-target="#what-to-match-between-teacher-and-student-network">2. What to match between Teacher and Student Network?</a>
  <ul class="collapse">
  <li><a href="#output-logits" id="toc-output-logits" class="nav-link" data-scroll-target="#output-logits">2.1 Output logits</a></li>
  <li><a href="#intermediate-weights" id="toc-intermediate-weights" class="nav-link" data-scroll-target="#intermediate-weights">2.2 Intermediate weights</a></li>
  <li><a href="#intermediate-features" id="toc-intermediate-features" class="nav-link" data-scroll-target="#intermediate-features">2.3 Intermediate features</a></li>
  <li><a href="#gradients" id="toc-gradients" class="nav-link" data-scroll-target="#gradients">2.4 Gradients</a></li>
  <li><a href="#sparsity-patterns" id="toc-sparsity-patterns" class="nav-link" data-scroll-target="#sparsity-patterns">2.5 Sparsity patterns</a></li>
  <li><a href="#relational-information-different-layers" id="toc-relational-information-different-layers" class="nav-link" data-scroll-target="#relational-information-different-layers">2.6.1 Relational information: Different Layers</a></li>
  <li><a href="#relational-information-different-samples" id="toc-relational-information-different-samples" class="nav-link" data-scroll-target="#relational-information-different-samples">2.6.1 Relational information: Different Samples</a></li>
  </ul></li>
  <li><a href="#self-and-online-distillation" id="toc-self-and-online-distillation" class="nav-link" data-scroll-target="#self-and-online-distillation">3. Self and Online Distillation</a>
  <ul class="collapse">
  <li><a href="#self-distillation" id="toc-self-distillation" class="nav-link" data-scroll-target="#self-distillation">3.1 Self Distillation</a></li>
  <li><a href="#online-distillation" id="toc-online-distillation" class="nav-link" data-scroll-target="#online-distillation">3.2 Online Distillation</a></li>
  <li><a href="#combined-distillation" id="toc-combined-distillation" class="nav-link" data-scroll-target="#combined-distillation">3.3 Combined Distillation</a></li>
  </ul></li>
  <li><a href="#distillation-for-different-tasks" id="toc-distillation-for-different-tasks" class="nav-link" data-scroll-target="#distillation-for-different-tasks"><strong>4. Distillation for different tasks</strong></a>
  <ul class="collapse">
  <li><a href="#object-detection" id="toc-object-detection" class="nav-link" data-scroll-target="#object-detection">4.1 Object Detection</a></li>
  <li><a href="#semantic-segmentation" id="toc-semantic-segmentation" class="nav-link" data-scroll-target="#semantic-segmentation">4.2 Semantic Segmentation</a></li>
  <li><a href="#gan" id="toc-gan" class="nav-link" data-scroll-target="#gan">4.3 GAN</a></li>
  <li><a href="#transformer" id="toc-transformer" class="nav-link" data-scroll-target="#transformer">4.4 Transformer</a></li>
  </ul></li>
  <li><a href="#network-augmentation-a-training-technique-for-tiny-machine-learning-models." id="toc-network-augmentation-a-training-technique-for-tiny-machine-learning-models." class="nav-link" data-scroll-target="#network-augmentation-a-training-technique-for-tiny-machine-learning-models.">5. Network Augmentation, <strong>a training technique for tiny machine learning models.</strong></a>
  <ul class="collapse">
  <li><a href="#network-augmentation" id="toc-network-augmentation" class="nav-link" data-scroll-target="#network-augmentation">5.2 Network Augmentation</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">üßë‚Äçüè´ Lecture 9</h1>
  <div class="quarto-categories">
    <div class="quarto-category">lecture</div>
    <div class="quarto-category">knowledge distillation</div>
  </div>
  </div>

<div>
  <div class="description">
    Knowledge Distillation(KD)
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Seunghyun Oh </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 19, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<style>
p {
  line-height: 2; /* Adjust the line-height property as needed */
  text-align: justify;
  text-justify: inter-word; /* Adjust the justification mode as needed */
}

.image-container {
  text-align: center; /* Center-align the contents horizontally */
}

.centered-text {
  text-align: center; /* Center-align the text within the container */
}
</style>
<p>Ïù¥Î≤à ÏãúÍ∞ÑÏùÄ Knowledge Distillation Í∏∞Î≤ïÏóê ÎåÄÌï¥ÏÑú Ïù¥ÏïºÍ∏∞ Ìï¥Î≥ºÍπå Ìï¥Ïöî. ÏßÄÍ∏àÍπåÏßÄ <strong>ÏûëÏùÄ ÌÅ¨Í∏∞Ïùò Î™®Îç∏ÏùÑ ÎßåÎìúÎäî Î∞©Î≤ïÏóê ÎåÄÌï¥ÏÑú</strong> ÏïåÏïÑÎ¥§ÏßÄÎßå, Ïó¨Ï†ÑÌûà ÏûëÏùÄ Î™®Îç∏ÏùÄ ÏÑ±Îä•Ï†ÅÏúºÎ°ú Î∂ÄÏ°±Ìïú Ï†êÏù¥ ÎßéÏ£†. ÏÑ±Îä•ÏùÑ Í∞úÏÑ†ÏãúÌÇ§Îäî Îã§Î•∏ Î∞©Î≤ïÏóê ÎåÄÌï¥ÏÑú Í≥†ÎØºÌïòÎã§Í∞Ä <strong>‚ÄúÌÅ¨Í∏∞Í∞Ä ÌÅ∞ Î™®Îç∏ÏùÑ Ïù¥Ïö©Ìï¥Î≥¥Ïûê.‚Äù</strong> ÏóêÏÑú ÎÇòÏò® ÏïÑÏù¥ÎîîÏñ¥Í∞Ä Î∞îÎ°ú Knowledge Distillation ÏûÖÎãàÎã§.</p>
<section id="what-is-knowledge-distillation" class="level2">
<h2 class="anchored" data-anchor-id="what-is-knowledge-distillation">1. What is Knowledge Distillation?</h2>
<p>Knowledge DistillationÏùÄ Í∞ÑÎã®ÌïòÍ≤å Teach NetworkÎùºÍ≥† Î∂àÎ¶¨Îäî ÌÅ¨Í∏∞Í∞Ä ÌÅ∞ Î™®Îç∏Ïù¥ ÏûàÏñ¥Ïöî. Ïù¥ Teacher NetworkÍ∞Ä Î®ºÏ†Ä TrainingÏùÑ Ìï©ÎãàÎã§. Í∑∏Îü∞ Îã§Ïùå Ïò§ÎäòÏùò Ï£ºÏù∏Í≥µ <strong>Student Network</strong>Î°ú Î∂àÎ¶¨Îäî ÌÅ¨Í∏∞Í∞Ä ÏûëÏùÄ Î™®Îç∏Ïù¥ ÏûàÏ£†. Ïù¥ Î™®Îç∏ÏùÄ Îëê Í∞ÄÏßÄ Î∞©ÏãùÏúºÎ°ú ÌïôÏäµÏùÑ ÌïòÎäîÎç∞, Ï≤´ Î≤àÏß∏Îäî Í∏∞Ï°¥Ïóê ÌïôÏäµÌïòÎçò ÎåÄÎ°ú Target Îç∞Ïù¥ÌÑ∞Î°úÎ∂ÄÌÑ∞ ÌïôÏäµÏù¥ ÏûàÍµ¨Ïöî. Îã§Î•∏ Ìïú Í∞ÄÏßÄÎäî <strong>Teacher Network</strong>Î•º Îî∞ÎùºÍ∞ÄÎäî ÌïôÏäµÏù¥ ÏûàÏäµÎãàÎã§.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Knowledge Distillation: A Survey [Gou&nbsp;et al., IJCV 2020]</figcaption>
</figure>
</div>
<ul>
<li>The goal of knowledge distillation is to align the class probability distributions from teacher and student networks.</li>
</ul>
<p>Í∑∏Îüº Í∂ÅÍ∏àÌïú Ï†êÏù¥ <strong>Teacher NetworkÏóê Ïñ¥Îñ§ Ï†êÏùÑ Î∞∞ÏõåÏïºÌï†ÍπåÏöî?</strong> Í∞ïÏùòÏóêÏÑúÎäî Ï¥ù 6Í∞úÎ°ú Output logit, Intermediate weight, Intermediate feature, Gradient, Sparsity pattern, Relational informationÏúºÎ°ú ÎÇòÎà†ÏÑú ÏÑ§Î™ÖÌï©ÎãàÎã§. ÏÑ§Î™ÖÌïòÍ∏∞Ïóê ÏïûÏÑúÏÑú Í∞úÎÖêÌïòÎÇò ÏÜåÍ∞úÌïòÍ≥† ÎÑòÏñ¥Í∞àÍªòÏöî.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 1.png" class="img-fluid figure-img"></p>
<figcaption>Reference. MIT-TinyML-lecture10-Knowledge-Distillation in <a href="https://efficientml.ai/">https://efficientml.ai</a></figcaption>
</figure>
</div>
<p>ÎßåÏïΩ ÏúÑ Teacher NetworkÍ∞Ä ÌïôÏäµÌïú Í≤∞Í≥º(T=1)Î°ú Í≥†ÏñëÏù¥ ÏÇ¨ÏßÑÏùº ÌôïÎ•† 0.982, Í∞ïÏïÑÏßÄ ÏÇ¨ÏßÑÏùº ÌôïÎ•†Ïù¥ 0.017Ïù¥ÎùºÍ≥† Ìï©ÏãúÎã§. Í∑∏Îüº Student NetworkÎäî Output logitÏùÑ ÌïôÏäµÌïúÎã§Í≥† Í∞ÄÏ†ïÌïòÎ©¥, Ïù¥ Îëê ÌôïÎ•†ÏùÑ Îî∞Îùº Í∞àÍ≤ÅÎãàÎã§. ÌïòÏßÄÎßå Student NetworkÏóê Îî∞Îùº Ïù¥ ÏàòÏπòÍπåÏßÄ ÌïôÏäµÌïòÍ∏∞ Ïñ¥Î†§Ïö∏ Ïàò ÏûàÏäµÎãàÎã§. Ïù¥ Îïå ‚Äú<strong>Temperature(T)</strong>‚ÄùÏù¥ÎùºÎäî Í∞úÎÖêÏùÑ Îì§Ïó¨ÏôÄ Teacher NetworkÏùò CatÍ≥º DogÏóê ÎåÄÌïú ÌôïÎ•†ÏùÑ Ï¢Ä Îçî SmoothÌïòÍ≤å ÎßåÎì§Ï£†.</p>
<p><span class="math display">\[
p(z_i,T) = \dfrac{exp(z_j/T)}{\sum_j exp(z_j/T)}
\]</span></p>
<p>ÏãùÏúºÎ°ú Ïì∞Î©¥ ÏúÑÏôÄ Í∞ôÏù¥ Îê†ÌÖêÎç∞, <strong>Î≥¥ÌÜµÏùÄ 1Î°ú ÎëêÍ≥†</strong> ÌïúÎã§Í≥† Í∞ïÏùòÏóêÏÑú Ïñ∏Í∏âÌï©ÎãàÎã§. Ïôú ÏÑ§Î™ÖÌñàÎÉêÍµ¨Ïöî? ÌòπÏãúÎÇò Í∞úÎÖêÏù¥ ÎÇòÏò§Î©¥ Ïù¥Ìï¥ÌïòÏãúÍ∏∞ Ìé∏ÌïòÏãúÎùºÍµ¨ÏöîüôÇ&nbsp;Í∑∏Îüº, <strong>Teacher NetworkÏóêÏÑú Ïñ¥Îñ§ Î∂ÄÎ∂ÑÏùÑ Student NetworkÏóê ÌïôÏäµÏãúÌÇ¨ÏßÄ</strong> ÏïåÏïÑÎ≥¥ÏãúÏ£†.</p>
</section>
<section id="what-to-match-between-teacher-and-student-network" class="level2">
<h2 class="anchored" data-anchor-id="what-to-match-between-teacher-and-student-network">2. What to match between Teacher and Student Network?</h2>
<section id="output-logits" class="level3">
<h3 class="anchored" data-anchor-id="output-logits">2.1 Output logits</h3>
<p>Ï≤´ Î≤àÏß∏Îäî Output logitÏûÖÎãàÎã§. lossÎ°úÎäî ÎåÄÌëúÏ†ÅÏúºÎ°ú Cross entropy lossÏôÄ L2 lossÍ∞Ä ÏûàÍ≤†Ï£†.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 2.png" class="img-fluid figure-img"></p>
<figcaption>Reference. MIT-TinyML-lecture10-Knowledge-Distillation in <a href="https://efficientml.ai/">https://efficientml.ai</a></figcaption>
</figure>
</div>
</section>
<section id="intermediate-weights" class="level3">
<h3 class="anchored" data-anchor-id="intermediate-weights">2.2 Intermediate weights</h3>
<p>Îëê Î≤àÏß∏Îäî LayerÎßàÎã§ WeightÏûÖÎãàÎã§. ÌïòÏßÄÎßå <strong>Student ModelÏùÄ Weight dimesionÏù¥ Îã§Î•º Ïàò Î∞ñÏóê ÏóÜÎäîÎç∞</strong>, Í∑∏Îüº Linear TransformationÏùÑ Ïù¥Ïö©Ìï¥ÏÑú DimensionÏùÑ ÎßûÏ∂∞ ÌïôÏäµÌïòÎ©¥ ÎêòÍ≤†ÎÑ§Ïöî.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 3.png" class="img-fluid figure-img"></p>
<figcaption>Reference. MIT-TinyML-lecture10-Knowledge-Distillation in <a href="https://efficientml.ai/">https://efficientml.ai</a></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 4.png" class="img-fluid figure-img"></p>
<figcaption>Reference. MIT-TinyML-lecture10-Knowledge-Distillation in <a href="https://efficientml.ai/">https://efficientml.ai</a></figcaption>
</figure>
</div>
<p>Ïä§ÌÑ∞Îîî Ï§ëÏóê ÎÇòÏò® ÏßàÎ¨∏Ïù¥ ‚ÄúÍ∑∏Îüº Student NetworkÏóêÏÑú Ï∂îÍ∞ÄÏ†ÅÏù∏ Î†àÏù¥Ïñ¥Í∞Ä ÏÉùÍ∏∞ÎäîÎç∞, ÏûëÍ≤å ÎßåÎìúÎäî ÏùòÎØ∏Í∞Ä ÏóÜÏßÄ ÏïäÎäêÎÉê?‚Äù ÏòÄÏäµÎãàÎã§. Ï†ú ÏÉùÍ∞ÅÏùÄ Weight DimensionÏùÑ ÎßûÏ∂îÍ∏∞ ÏúÑÌïú Linear TransformationÏùÑ ÏúÑÌïú Î†àÏù¥Ïñ¥Îäî Ï∂îÎ°†Ïãú ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÏùÑ Ïàò ÏûàÏúºÎãà, Student NetworkÏùò ÏÑ±Îä•ÏùÑ ÎÜíÏù¥Í∏∞ Îçî Ï†úÍ≤©ÏïÑÎãêÍπåÏöî? ÎßàÏπò Ï∂îÎ°† Îïå ÌïÑÏöîÌïú Î∂ÄÌíàÎßå Ï°∞Î¶ΩÌïòÎìØ ÎßêÏù¥Ï£†.</p>
</section>
<section id="intermediate-features" class="level3">
<h3 class="anchored" data-anchor-id="intermediate-features">2.3 Intermediate features</h3>
<p>ÏÑ∏ Î≤àÏß∏Îäî Feature ÏûÖÎãàÎã§. Ïù¥Ï†Ñ Í≤ΩÏö∞Í∞Ä WeightÎùºÍ≥† ÌïòÎ©¥, Ïù¥Î≤àÏùÄ LayerÏùò OutputÏûÖÎãàÎã§. Teach NetworkÍ≥º Student NetworkÏùò FeatureÎ•º Í∞ôÍ≤å ÌïôÏäµÏãúÌÇ§Îäî Î∞©Î≤ïÏùÄ Ïó¨Îü¨Í∞ÄÏßÄÍ∞Ä ÏûàÎäîÎç∞, Ïó¨Í∏∞ÏÑúÎäî Cosine of angleÎ°ú ÌïôÏäµÏùÑ ÏãúÌÇ§Îäî Î∞©Î≤ï(<a href="https://arxiv.org/pdf/1707.01219.pdf">Like What You Like: Knowledge Distill via Neuron Selectivity Transfer [Huang and Wang, arXiv 2017]</a>) Í≥º DimensionÏùÑ Ï§ÑÏó¨ÏÑú ÌïôÏäµÏùÑ ÏãúÌÇ§Îäî Î∞©Î≤ï(<a href="https://arxiv.org/pdf/1802.04977.pdf">Paraphrasing Complex Network: Network Compression via Factor Transfer [Kim&nbsp;<em>et al.</em>, NeurIPS 2018]</a>)ÏùÑ ÏÜåÍ∞úÌï©ÎãàÎã§.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 5.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Like What You Like: Knowledge Distill via Neuron Selectivity Transfer [Huang and Wang, arXiv 2017]</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 6.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Paraphrasing Complex Network: Network Compression via Factor Transfer [Kim&nbsp;<em>et al.</em>, NeurIPS 2018]</figcaption>
</figure>
</div>
<ul>
<li>The paraphraser shrinks the output teacher feature map from m dimensions to m x k dimensions (called <strong>factor</strong> typically k=0.5) and then expands the dimensionality back to m.</li>
<li>The output of paraphraser is supervised with a reconstruction loss against the original m-dimensional output.</li>
<li>Student uses one layer of MLP to obtain a <strong>factor</strong> with the same dimensionality of m x k.</li>
<li>FT minimizes the distance between teacher and student factors.</li>
</ul>
</section>
<section id="gradients" class="level3">
<h3 class="anchored" data-anchor-id="gradients">2.4 Gradients</h3>
<p>ÎÑ§ Î≤àÏß∏Îäî Gradient ÏûÖÎãàÎã§. GradientÎ•º ÏãúÍ∞ÅÏ†ÅÏúºÎ°ú Î≥º Ïàò ÏûàÎäî Î∞©Î≤ïÏóêÎäî Attention MapÏù¥ ÏûàÎäîÎç∞Ïöî, Ïù¥ Attention MapÏùÄ Ïù¥ÎØ∏ÏßÄÏóêÏÑú ÌäπÏßïÏ†ÅÏù∏ Î∂ÄÎ∂ÑÏùÑ Ïû°ÏïÑÎÇº Ïàò ÏûàÏ£†.</p>
<ul>
<li>Reference: Paying More Attention to Attention: Improving the Performance of Convolutional Neural Networks via Attention Transfer [Zagoruyko and Komodakis, ICLR 2017]</li>
<li>Gradients of feature maps are used to characterize attention of DNNs</li>
<li>The attention of a CNN feature map <span class="math inline">\(x\)</span> is defined as <span class="math inline">\(\dfrac{\partial L}{\partial x}\)</span>, where <span class="math inline">\(L\)</span> is the learning objective.</li>
<li>Intuition: If <span class="math inline">\(\dfrac{\partial L}{\partial x_{i,j}}\)</span> is large, a small perturbation at <span class="math inline">\(i,j\)</span> will significantly impact the final output. As a result, the network is putting more attention on position <span class="math inline">\(i, j\)</span></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 7.png" class="img-fluid figure-img"></p>
<figcaption>Reference. MIT-TinyML-lecture10-Knowledge-Distillation in <a href="https://efficientml.ai/">https://efficientml.ai</a></figcaption>
</figure>
</div>
<p>ÏïÑÎûò Í∑∏Î¶ºÏùÄ <strong>‚ÄúAttention MapÏù¥ Î™®Îç∏Ïùò ÏÑ±Îä•Ïù¥ ÎÜíÎã§Î©¥ ÎπÑÏä∑Ìïú Ìå®ÌÑ¥ÏúºÎ°ú ÎÇòÏò®Îã§.‚Äù</strong> Îäî ÏòàÏãúÎ°ú ÎÇòÏòµÎãàÎã§. Resnet34ÏôÄ ResNet101Ïùò Attention MapÏùÄ Ïú†ÏÇ¨ÌïòÍ≤å Î≥¥Ïù¥Îäî Î∞òÎ©¥ NINÏù∏ Í≤ΩÏö∞Îäî ÎßéÏù¥ Îã§Î•∏ Í≤ÉÏùÑ ÌôïÏù∏ Ìï† Ïàò ÏûàÏäµÎãàÎã§.</p>
<ul>
<li><p>Performant models have similar attention maps</p>
<p>Attention makes of performant ImageNet models (ResNets) are indeed similar to each other, but the less performant model(NIN) has quite different attention maps</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 8.png" class="img-fluid figure-img"></p>
<figcaption>Reference. MIT-TinyML-lecture10-Knowledge-Distillation in <a href="https://efficientml.ai/">https://efficientml.ai</a></figcaption>
</figure>
</div></li>
</ul>
</section>
<section id="sparsity-patterns" class="level3">
<h3 class="anchored" data-anchor-id="sparsity-patterns">2.5 Sparsity patterns</h3>
<p>Îã§ÏÑØ Î≤àÏß∏Îäî Sparsity Pattern ÏûÖÎãàÎã§. LayerÎßàÎã§ Output AcitivationÏùÑ Í∞ôÍ≤å ÎßåÎìúÎäî Î∞©Î≤ïÏù∏Îç∞, Intermediate FeatureÏôÄ Ïú†ÏÇ¨ÌïòÍ≤å Î≥¥Ïù¥ÎÑ§Ïöî.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 9.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Knowledge Transfer via Distillation of Activation Boundaries Formed by Hidden Neurons [Heo&nbsp;<em>et al.</em>, AAAI 2019]</figcaption>
</figure>
</div>
<ul>
<li><p>Intuition: the teacher and student networks should have similar sparsity patterns after the ReLU activation. A neuron is activated after ReLU if its value is larger than 0, denoted by the indicator function <span class="math inline">\(\rho(x) = 1 [x&gt;0]\)</span>.</p></li>
<li><p>We want to minimize <span class="math inline">\(\mathscr{L}(I) = \lvert\lvert \rho(T(I))-\rho(S(I)) \lvert\lvert_1\)</span>, where <span class="math inline">\(S\)</span> and <span class="math inline">\(T\)</span> corresponds to student and teacher networks, respectively</p></li>
</ul>
</section>
<section id="relational-information-different-layers" class="level3">
<h3 class="anchored" data-anchor-id="relational-information-different-layers">2.6.1 Relational information: Different Layers</h3>
<p>ÎßàÏßÄÎßâÏúºÎ°ú Î™®Îç∏ÎÇ¥ÏóêÏÑú ÎÇòÏò§Îäî ÌÖêÏÑúÏùò ÏÉÅÌò∏ Ïó∞Í¥ÄÏÑ±Ïóê ÎåÄÌï¥ÏÑúÎèÑ Í∞ôÍ≤å Ìï† Ïàò ÏûàÎã§Îäî Î∞©Î≤ï Îëê Í∞ÄÏßÄÍ∞Ä ÎÇòÏòµÎãàÎã§. Ï≤´ Î≤àÏß∏Îäî Í∞Å Î†àÏù¥Ïñ¥Ïùò ÏûÖÎ†•, Ï∂úÎ†• ÌÖêÏÑúÎ•º Inner product ÌïòÍ≤å ÎêòÎ©¥ ÌïòÎÇòÏùò MatrixÎ•º ÏñªÏùÑ Ïàò ÏûàÎäîÎç∞, Ïù¥ MatrixÎ•º Í∞ôÍ≤å ÌïôÏäµÏãúÌÇ®Îã§Îäî ÏïÑÏù¥ÎîîÏñ¥Ï£†.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/KD-related-info.gif" class="img-fluid figure-img"></p>
<figcaption>Reference: A Gift from Knowledge Distillation: Fast Optimization, Network Minimization and Transfer Learning [Yim&nbsp;<em>et al.</em>, CVPR 2017]</figcaption>
</figure>
</div>
<ol type="1">
<li><p>Use <strong>inner product to extract relational information</strong> (a matrix of shape <span class="math inline">\(C_{in} \times C_{out}\)</span>, reduction on the spatial dimensions) for both student and teacher networks. *Note: the student and teacher networks only differ in number of layers, not number of channels</p></li>
<li><p>Then match the resulting <strong>dot products between teacher and student networks</strong> <span class="math inline">\((G_1^T, G_1^S)\)</span></p></li>
</ol>
</section>
<section id="relational-information-different-samples" class="level3">
<h3 class="anchored" data-anchor-id="relational-information-different-samples">2.6.1 Relational information: Different Samples</h3>
<p>Îëê Î≤àÏß∏Îäî Ïù¥Ï†ÑÍπåÏßÄ Ï†ÄÌù¨Îäî ÌïôÏäµÎç∞Ïù¥ÌÑ∞ ÌïòÎÇòÌïòÎÇòÎßàÎã§ ÎÇòÏò§Îäî Í≤∞Í≥ºÎ•º TeachÏôÄ StudentÎ•º Í∞ôÍ≤åÎÅî ÌïôÏäµÏãúÏº∞ÎäîÎç∞, Ïù¥Î≤àÏóî <strong>Ïó¨Îü¨ ÌïôÏäµÎç∞Ïù¥ÌÑ∞ÏóêÏÑú ÎÇòÏò® Ïó¨Îü¨ OutputÏùÑ ÌïòÎÇòÏùò Matrix ÌòïÌÉú</strong>Î°ú ÎãÆÍ≤å ÎßåÎìúÎäî Î∞©Î≤ïÏûÖÎãàÎã§.</p>
<ul>
<li><strong>Conventional KD</strong> focuses on matching features / logins <strong>for one input</strong>. <strong>Relation KD</strong> looks at the relations between intermediate features <strong>from multiple inputs.</strong></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 10.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Relational Knowledge Distillation [Park&nbsp;<em>et al.</em>, CVPR 2019]</figcaption>
</figure>
</div>
<ul>
<li><p>Relation between different samples</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 11.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Relational Knowledge Distillation [Park&nbsp;<em>et al.</em>, CVPR 2019]</figcaption>
</figure>
</div></li>
</ul>
<p>ÏßÄÍ∏àÍπåÏßÄ Student NetworkÍ∞Ä Teacher NetworkÏùò Ïñ¥Îñ§ OutputÏùÑ Í∞ÄÏßÄÍ≥† ÌïôÏäµÏãúÌÇ¨ÏßÄÏóê ÎåÄÌï¥ÏÑú ÏïåÏïÑÎ¥§ÏäµÎãàÎã§. Í∑∏Îü∞Îç∞ Ï†ÄÌù¨Í∞Ä TinyMLÏùÑ ÌïòÎäî Î™©Ï†ÅÏùÄ ÏÇ¨Ïã§ <strong>‚ÄúÎçî ÏûëÏùÄ ÎÑ§Ìä∏ÏõåÌÅ¨Î•º ÏÇ¨Ïö©Ìï¥Î≥¥Ïûê.‚Äù</strong> Ïù¥ÏßÄ ÏïäÏïòÎÇòÏöî? Ï¶â, Teacher NetworkÏóÜÏù¥ Student NetworkÎßåÏúºÎ°úÎäî Ìï† Ïàò ÏûàÎäî Î∞©Î≤ïÏù¥ ÏóÜÏùÑÍπåÏöî? Ïù¥Îü∞ ÏÉùÍ∞ÅÏóêÏÑú ÎÇòÏò® ÏïÑÏù¥ÎîîÏñ¥Í∞Ä Self and Online Distillation ÏûÖÎãàÎã§.</p>
</section>
</section>
<section id="self-and-online-distillation" class="level2">
<h2 class="anchored" data-anchor-id="self-and-online-distillation">3. Self and Online Distillation</h2>
<ul>
<li>What is the disadvantage of fixed large teachers? Does it have to be the case that we need a fixed large teacher in KD?</li>
</ul>
<section id="self-distillation" class="level3">
<h3 class="anchored" data-anchor-id="self-distillation">3.1 Self Distillation</h3>
<p>Ï≤´ Î≤àÏß∏ Self DistillationÏùÄ Íµ¨Ï°∞Í∞Ä Í∞ôÏùÄ ÎÑ§Ìä∏ÏõåÌÅ¨Î•º Í≥ÑÏÜçÌï¥ÏÑú Î≥µÏÇ¨Ìï¥ ÎÇòÍ∞ëÎãàÎã§. Í∑∏Îü¨Î©¥ÏÑú Ïù¥Ï†ÑÏóê ÌïôÏäµÌïú ÎÑ§Ìä∏ÏõåÌÅ¨Î°ú Î∂ÄÌÑ∞ÎèÑ Î≥µÏÇ¨Îêú ÎÑ§Ìä∏ÏõåÌÅ¨Í∞Ä ÌïôÏäµÌï† Ïàò ÏûàÎèÑÎ°ù ÌïòÎ©∞, kÍ∞ú ÎßåÌÅº Î≥µÏÇ¨ÌïòÎ©∞ ÌïôÏäµÌïú ÌõÑÏóê ÏµúÏ¢Ö OutputÏúºÎ°úÎäî Î≥µÏÇ¨Ìïú ÎÑ§Ìä∏ÏõåÌÅ¨Îì§Ïùò OutputÏùÑ EnsembleÌïú Í≤∞Í≥ºÎ•º Ïù¥Ïö©ÌïòÏ£†. Ïó¨Í∏∞ÏÑú AccuracyÎäî kÎ≤àÏß∏Î°ú Í∞àÏàòÎ°ù ÎäòÏñ¥ÎÇòÍ≤†Ï£†?</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 12.png" class="img-fluid figure-img"></p>
<figcaption>Born-Again Neural Networks [Furlanello et al., ICML 2018]</figcaption>
</figure>
</div>
<ul>
<li><p>Born-Again Networks generalizes defensive distillation by <strong>adding iterative training states</strong> and <strong>using both classification objective and distillation objective</strong> in subsequent stages.</p></li>
<li><p>Network architecture <span class="math inline">\(T = S_1=S_2=\dots=S_k\)</span></p></li>
<li><p>Network accuracy <span class="math inline">\(T &lt; S_1 &lt; S_2 &lt; \dots &lt; S_k\)</span></p></li>
<li><p>Can alteratively ensemble <span class="math inline">\(T,S_1, S_2, \dots, S_k\)</span> to get even better performance</p></li>
</ul>
</section>
<section id="online-distillation" class="level3">
<h3 class="anchored" data-anchor-id="online-distillation">3.2 Online Distillation</h3>
<p>Îëê Î≤àÏß∏Îäî Online DistillationÏù∏Îç∞, Ïó¨Í∏∞ ÏïÑÏù¥ÎîîÏñ¥Îäî <strong>‚ÄúÍ∞ôÏùÄ ÎÑ§Ìä∏ÏõåÌÅ¨ Íµ¨Ï°∞Î•º Ïì∞Ïûê.‚Äù</strong> ÏûÖÎãàÎã§. Í∑∏Î¶¨Í≥† Teacher networkÍ≥º Student networkÎäî Ï≤òÏùåÎ∂ÄÌÉÄ Í∞ôÏù¥ ÌïôÏäµÌïòÎäîÎç∞, LossÏóê Ìïú Í∞ÄÏßÄ Ìï≠Ïù¥ Ï∂îÍ∞ÄÎêòÏ£†. Î∞îÎ°ú ‚ÄúKL Divergence‚Äù ÏûÖÎãàÎã§.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 13.png" class="img-fluid figure-img"></p>
<figcaption>Reference: Deep Mutual Learning [Zhang&nbsp;et al., CVPR 2018]</figcaption>
</figure>
</div>
<ul>
<li><p>Idea: for both teach and student networks, we want to add a distillation objective that minimizes the output distribution of the other party.</p></li>
<li><p><span class="math inline">\(\mathscr{L}(S) = CrossEntropy(S(I), y)+KL(S(I), T(I))\)</span></p></li>
<li><p><span class="math inline">\(\mathscr{L}(T) = CrossEntropy(T(I), y)+KL(S(I), T(I))\)</span></p></li>
<li><p>It is not necessary to retrain <span class="math inline">\(T\)</span> and <span class="math inline">\(S=T\)</span> is allowed</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 14.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Deep Mutual Learning [Zhang&nbsp;et al., CVPR 2018]</figcaption>
</figure>
</div></li>
</ul>
</section>
<section id="combined-distillation" class="level3">
<h3 class="anchored" data-anchor-id="combined-distillation">3.3 Combined Distillation</h3>
<p>ÎßàÏßÄÎßâÏùÄ Self ÏôÄ Online DistillationÏùÑ Ìï©Ïπú Ïó∞Íµ¨Îì§ÏùÑ ÏÜåÍ∞úÌï†Í≤åÏöî.</p>
<p>Ï≤´ Î≤àÏß∏Îäî On-the-Fly Native Ensemble ÏûÖÎãàÎã§. Íµ¨Ï°∞Î•º Î≥¥ÏãúÎ©¥ Branch ÎßàÎã§ Î™®Îç∏Ïùò Íµ¨Ï°∞ÎèÑ ÎèôÏùºÌïòÍ≤å Branch 0, Branch 1, ‚Ä¶ , Branch m ÏúºÎ°ú ÎÇòÎâòÎäî Í≤å Self DistillationÎ•º Î≥¥Îäî ÎìØÌïòÏ£†. Í∑∏Î¶¨Í≥† Í∞Å BranchÎ•º ÌïôÏäµÏãú ÎèôÏãúÏóê ÏßÑÌñâÌïòÎäî Í≤ÉÏúºÎ°ú Î≥¥Ïù¥ÎÑ§Ïöî.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 15.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Knowledge Distillation by On-the-Fly Native Ensemble [Lan et al., NeurlPS 2018]</figcaption>
</figure>
</div>
<ul>
<li><p>Idea: generating <strong>multiple</strong> output probability distributions and <strong>ensemble</strong> them as the target distribution for knowledge distillation.</p></li>
<li><p>Similar to DML(Deep Mutual Learning), ONE allows the teacher model to be exactly the same as the student model, and it does not require retraining the teach network first. It is also not necessary to train two models as in DML.</p></li>
<li><p>Result</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 16.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Knowledge Distillation by On-the-Fly Native Ensemble [Lan et al., NeurlPS 2018]</figcaption>
</figure>
</div></li>
</ul>
<p>Îëê Î≤àÏß∏ Ïó∞Íµ¨Îäî Be Your Own Teacher ÎùºÎäî Ïó∞Íµ¨Ïù∏Îç∞, Ïó¨Í∏∞ÏÑúÎäî Í∞Å Î†àÏù¥Ïñ¥ÎßàÎã§ ÎÇòÏò® Feature mapÏóê Ï∂îÍ∞ÄÏ†ÅÏù∏ Î†àÏù¥Ïñ¥Î•º Î∂ôÏó¨ÏÑú Self DistillationÏùò Î∞©Î≤ïÏùÑ Ïù¥Ïö©Ìï©ÎãàÎã§. LossÎ°úÎäî Cross entropy(Output Logit), Ï∂îÍ∞ÄÏ†ÅÏúºÎ°ú Î∂ôÏó¨ÏÑú ÎßåÎì† Í∞Å Î™®Îç∏ÎßàÎã§ KL Divergence, Í∑∏Î¶¨Í≥† intermediate featureÎ•º ÏÇ¨Ïö©ÌïòÎÑ§Ïöî. Ìù•ÎØ∏Î°úÏõ†Îçò Ï†êÏùÄ Ï≤´ Î≤àÏß∏, Îëê Î≤àÏß∏ Î†àÏù¥Ïñ¥ÏóêÏÑúÎäî ÏÑ±Îä•Ïù¥ Í±∞Ïùò ÎÇòÏò§ÏßÄ ÏïäÏùÑ Í≤É Í∞ôÏïòÎäîÎç∞ Îëê Î≤àÏß∏ Î†àÏù¥Ïñ¥Î∂ÄÌÑ∞Îäî EnsembleÍπåÏßÄ Ïñ¥ÎäêÏ†ïÎèÑ ÏÑ±Îä•Ïù¥ ÎÇòÏò§Îäî Í≤ÉÏùÑ Í≤∞Í≥ºÏóêÏÑú Î≥º Ïàò ÏûàÏñ¥Ïöî.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 17.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Be Your Own Teacher: Improve the Performance of Convolutional Neural Networks via Self Distillation [Zhang&nbsp;<em>et al.</em>, ICCV 2019]</figcaption>
</figure>
</div>
<ul>
<li><p>Use deeper layers to distill shallower layers.</p></li>
<li><p>Intuition: Labels at later stages are more reliable, so the authors use them to supervise the predictions from the previous stages.</p></li>
<li><p>Result</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 18.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Be Your Own Teacher: Improve the Performance of Convolutional Neural Networks via Self Distillation [Zhang&nbsp;<em>et al.</em>, ICCV 2019]</figcaption>
</figure>
</div></li>
</ul>
</section>
</section>
<section id="distillation-for-different-tasks" class="level2">
<h2 class="anchored" data-anchor-id="distillation-for-different-tasks"><strong>4. Distillation for different tasks</strong></h2>
<p>Ïù¥Î†áÍ≤å ÏïåÏïÑÎ≥∏ Knowledge DistillationÏùÄ Ïñ¥Îñ§ ApplicationÏóê ÏÇ¨Ïö©Îê† Ïàò ÏûàÏùÑÍπåÏöî? Í∞ïÏùòÎäî Object Detection, Semantic Segmentation, GAN, Transformer Î™®Îç∏Î°ú ÎÇòÎà†ÏÑú Ïù¥ÏïºÍ∏∞Ìï©ÎãàÎã§. Í∞Å Î∂ÄÎ∂ÑÎßàÎã§ Ïñ¥Îñ§ Î¨∏Ï†úÎ•º Ìï¥Í≤∞ÌïòÎäîÏßÄ ÌòπÏùÄ Ïñ¥Îñ§ ÏïÑÏù¥ÎîîÏñ¥Î•º ÏÇ¨Ïö©ÌñàÎäîÏßÄÎßå ÏßöÍ≥† ÎÑòÏñ¥Í∞ÄÎ≥ºÍ≤åÏöî(ÏûêÏÑ∏Ìïú ÎÇ¥Ïö©ÏùÄ ÎÖºÎ¨∏ÏùÑ Ï∞∏Ï°∞!).</p>
<section id="object-detection" class="level3">
<h3 class="anchored" data-anchor-id="object-detection">4.1 Object Detection</h3>
<p>Object DetectionÏùÄ ÏÑ∏ Í∞ÄÏßÄÎ°ú Ìï¥Í≤∞Ìï¥ÏïºÌï† Î¨∏Ï†úÍ∞Ä ÎäòÏñ¥ÎÇ¨ÏäµÎãàÎã§. ÌïòÎÇòÎäî Classification, Í∑∏ÎèôÏïà Ìï¥ÏôîÎçò Î∂ÄÎ∂ÑÏù¥Íµ¨Ïöî, Îã§Î•∏ Îëê Í∞úÎäî BackgroundÏôÄ ForegroundÏùÑ Íµ¨Î∂ÑÌïòÎäî Í≤ÉÍ≥º Bounding block Î¨∏Ï†ú ÏûÖÎãàÎã§.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/object-detection-KD.gif" class="img-fluid figure-img"></p>
<figcaption>Reference. Object Detection: Learning Efficient Object Detection Models with Knowledge Distillation [Chen&nbsp;<em>et al.</em>, NeurIPS 2017]</figcaption>
</figure>
</div>
<p><a href="https://proceedings.neurips.cc/paper_files/paper/2017/file/e1e32e235eee1f970470a3a6658dfdd5-Paper.pdf">Ïù¥ Ïó∞Íµ¨</a>Îäî ClassifcationÍ≥º Background, Foreground Î¨∏Ï†úÎ•º ÏúÑÌï¥ ÏÑ∏ Í∞ÄÏßÄ LossÎ•º ÏÇ¨Ïö©Ìï©ÎãàÎã§. ÌïòÎÇòÎäî Feature, Í∑∏Î¶¨Í≥† Output LogitÏóêÏÑú Background, ForegroundÎ•º Í∞ÅÍ∞Å Îã§Î•∏ WeightÎ•º Ï§Ä Cross Entropy, ÎßàÏßÄÎßâÏùÄ Bounded Ìïú Regression Loss ÏûÖÎãàÎã§.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 19.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Localization: Localization Distillation for Dense Object Detection [Zheng&nbsp;<em>et al.</em>, CVPR 2022]</figcaption>
</figure>
</div>
<p>Í∑∏Îüº Bounding block ÏùÄ Ïñ¥ÎñªÍ≤å Ìï¥Í≤∞Ìï†ÍπåÏöî? <a href="https://arxiv.org/pdf/2102.12252.pdf">Ïù¥ ÎÖºÎ¨∏</a>ÏóêÏÑúÎäî XÏ∂ïÍ≥º YÏ∂ïÏúºÎ°ú 6Í∞úÎ°ú ÎÇòÎà†ÏßÑ Íµ¨Ïó≠ÏóêÏÑú Îëê Ï†êÏúºÎ°ú bounding blockÏùÑ Ïû°ÏäµÎãàÎã§. Ïù¥Î†áÍ≤å Ïû°ÏùÄ Bounding blockÏùò Î∂ÑÌè¨Î•º Student NetworkÍ∞Ä ÌïôÏäµÌïòÎäî Í≤ÅÎãàÎã§.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Lecture_09-Knowledge-Distillation_(4).jpg" class="img-fluid figure-img"></p>
<figcaption>Reference. Localization: Localization Distillation for Dense Object Detection [Zheng&nbsp;<em>et al.</em>, CVPR 2022]</figcaption>
</figure>
</div>
</section>
<section id="semantic-segmentation" class="level3">
<h3 class="anchored" data-anchor-id="semantic-segmentation">4.2 Semantic Segmentation</h3>
<p>Îëê Î≤àÏß∏ TaskÏù∏ Semantic SegmentationÏóêÏÑúÎäî FeatureÏôÄ Output LogitÏóêÏÑú <strong>Pixel Îã®ÏúÑÎ°ú Loss</strong>Î•º Íµ¨Ìïú Îã§Îäî Ï†ê, Í∑∏Î¶¨Í≥† <strong>Discriminator Î™®Îç∏</strong>ÏùÑ Í∞ÄÏßÄÍ≥† ÌïôÏäµÏùÑ ÏãúÌÇ®Îã§Îäî Ï†êÏù¥ ÎçîÌï¥Ï°åÏäµÎãàÎã§.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 20.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Semantic Segmentation: Structured Knowledge Distillation for Semantic Segmentation [Liu&nbsp;<em>et al.</em>, CVPR 2019]</figcaption>
</figure>
</div>
</section>
<section id="gan" class="level3">
<h3 class="anchored" data-anchor-id="gan">4.3 GAN</h3>
<p>ÏÑ∏Î≤àÏß∏ TaskÎäî GAN ÏûÖÎãàÎã§. Îß§ Task ÎßàÎã§ feature mapÏùÑ KD-lossÎ°ú Í∞ÄÏ†∏Í∞ÄÍ≥† Í∏∞Ï°¥Ïóê Output LogitÏùÄ ÎèôÏùºÌïòÍ≤å Í∞ÄÏ†∏Í∞ÄÎÑ§Ïöî. Ï∂îÍ∞ÄÎ°ú Ìï¥Îãπ Ïó∞Íµ¨ÏóêÏÑúÎäî Í∞Å Î†àÏù¥Ïñ¥ÎßàÎã§ Ï±ÑÎÑê Ïàò Ï§ë ÏÑ±Îä•Ïù¥ Í∞ÄÏû• Ï¢ãÏùÄ ÏºÄÏù¥Ïä§Ïóê ÌïúÌï¥ Fine-TuningÏùÑ ÏßÑÌñâÌïúÎã§Îäî Ï†êÏù¥ ÏûàÏäµÎãàÎã§.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/GAN-KD.gif" class="img-fluid figure-img"></p>
<figcaption>Reference. GAN: GAN Compression: Efficient Architectures for Interactive Conditional GANs [Li&nbsp;<em>et al.</em>, CVPR 2020]</figcaption>
</figure>
</div>
</section>
<section id="transformer" class="level3">
<h3 class="anchored" data-anchor-id="transformer">4.4 Transformer</h3>
<p>ÎßàÏßÄÎßâÏùÄ Transformer Î™®Îç∏ÏóêÏÑú Knowledge Distillation ÏûÖÎãàÎã§. TransformerÎäî Feature Map, Attention MapÏùÑ Ïïà Î≥º ÏàòÍ∞Ä ÏóÜÎäîÎç∞Ïöî, ÏïÑÎûò Í∑∏Î¶ºÏóêÏÑú Î≥¥Î©¥ attention transferÎ•º ÌïòÍ≥† ÌïòÏßÄ ÏïäÏùÄ Í≤ΩÏö∞ÌïòÍ≥† ÌôïÏã§Ìûà TeacherÏôÄ Attention mapÍ∞Ä ÎπÑÍµêÍ∞Ä ÎêòÎÑ§Ïöî.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Transformer-KD.gif" class="img-fluid figure-img"></p>
<figcaption>Refernece. NLP: MobileBERT: a Compact Task-Agnostic BERT for Resource-Limited Devices [Sun&nbsp;<em>et al.</em>, ACL 2020]</figcaption>
</figure>
</div>
</section>
</section>
<section id="network-augmentation-a-training-technique-for-tiny-machine-learning-models." class="level2">
<h2 class="anchored" data-anchor-id="network-augmentation-a-training-technique-for-tiny-machine-learning-models.">5. Network Augmentation, <strong>a training technique for tiny machine learning models.</strong></h2>
<p>ÏßÄÍ∏àÍπåÏßÄ TaskÏóê ÎåÄÌï¥ÏÑú ÏÇ¥Ìé¥Î¥§ÎäîÎç∞Ïöî, Í∑∏Îüº Tiny ModelÎèÑ overfitting Î¨∏Ï†úÍ∞Ä ÏûàÏßÄ ÏïäÏùÑÍπåÏöî? Í∑∏Î†àÏÑú overfittingÏùÑ Ìï¥Í≤∞ÌïòÎäî Î∞©Î≤ïÏóêÎäî Data AugmentationÏù¥ ÏûàÏäµÎãàÎã§. ÏïÑÎûò Í∑∏Î¶º Ï≤òÎüº Cutoff, Mixup, AutoAugment, DropoutÍ≥º Í∞ôÏùÄ Î∞©Î≤ïÎì§Ïù¥ ÏûàÏäµÎãàÎã§.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 21.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Data Augmentation(AutoAugment: Learning Augmentation Policies from Data [Cubuk&nbsp;<em>et al.</em>, CVPR 2019])</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 22.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Dropout(DropBlock: A regularization method for convolutional networks [Ghiasi&nbsp;<em>et al.</em>, NeurIPS 2018])</figcaption>
</figure>
</div>
<p>ÌïòÏßÄÎßå Data AugmentationÏùÑ Ï†ÅÏö©Ìïú Tiny ModelÏùò ÏÑ±Îä•ÏùÑ Î≥¥ÏãúÎ©¥ Ï†ÅÏö©ÌïòÎäî Î∞©Î≤ïÎßàÎã§ Îñ®Ïñ¥ÏßÄÎäî Í≤ÉÏùÑ ÌôïÏù∏Ìï† Ïàò ÏûàÏäµÎãàÎã§. Í∑∏ÎûòÏÑú Ïó¨Í∏∞ÏÑú Ï†úÏïàÌïú ÏïÑÏù¥ÎîîÏñ¥Í∞Ä ‚Äú<strong>Network Augmentation</strong>‚Äù ÏûÖÎãàÎã§.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 23.png" class="img-fluid figure-img"></p>
<figcaption>Reference. MIT-TinyML-lecture10-Knowledge-Distillation in <a href="https://efficientml.ai/">https://efficientml.ai</a></figcaption>
</figure>
</div>
<ul>
<li>Tiny Neural Network lacks capacity! ‚Üí NetAug</li>
</ul>
<section id="network-augmentation" class="level3">
<h3 class="anchored" data-anchor-id="network-augmentation">5.2 Network Augmentation</h3>
<p>Network AugmentationÏùÄ Í∏∞Ï°¥Ïóê ÎîîÏûêÏù∏Ìïú Î™®Îç∏ÏùÑ Í∞ÄÏßÄÍ≥† ÌïôÏäµÏùÑ ÏãúÌÇ® ÌõÑ, Ïõê Î™®Îç∏Í≥º <strong>Í∞Å Î†àÏù¥Ïñ¥ÎßàÎã§ ÌååÎùºÎØ∏ÌÑ∞Î•º Î≥ÄÍ≤ΩÌïú Î™®Îç∏ÏùÑ Ìï®Íªò Ïû¨ÌïôÏäµÏùÑ ÏãúÌÇ§Îäî Î∞©Î≤ï</strong>ÏûÖÎãàÎã§. ÌååÎùºÎØ∏ÌÑ∞Î•º Î≥ÄÍ≤ΩÌïòÎäî Î™®Îç∏Í∞ôÏùÄ Í≤ΩÏö∞ <a href="https://tinyml-kor.github.io/blog/posts/labs/lab03.html">Ïù¥Ï†ÑÏãúÍ∞Ñ Ïã§Ïäµ</a>Ïóê ÏûàÏúºÎãà Í∂ÅÍ∏àÌïòÏãúÎ©¥ Ï∞∏Í≥†Ìï¥Ï£ºÏÑ∏Ïöî. Ïã§ÌóòÍ≤∞Í≥ºÎäî 1.3 ~ 1.8 % Tiny Î™®Îç∏Ïù¥ ÏÑ±Îä• Í∞úÏÑ†Ïù¥ Ïù¥Î§ÑÏßÑ Í≤ÉÏùÑ Î≥º Ïàò ÏûàÏñ¥Ïöî. Ïó¨Í∏∞ÏÑú Ïõê Î™®Îç∏(ResNet50)Ïù¥ EvaluationÏóêÏÑúÎäî Ïù¥ÎØ∏ Í∞ÄÏßÑ Îç∞Ïù¥ÌÑ∞Î°ú Î™®Îç∏ÏùÑ Ï∂©Î∂ÑÌûà ÌõàÎ†®ÏãúÏº∞Í∏∞ ÎïåÎ¨∏Ïóê ÎçîÏù¥ÏÉÅ ÎäòÏñ¥ÎÇòÏßÄ ÏïäÎäî Í≤ÉÎèÑ ÌôïÏù∏Ìï† Ïàò ÏûàÍ≤†ÎÑ§Ïöî.</p>
<ul>
<li><p>Training Process</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 24.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Network Augmentation for Tiny Deep Learning [Cai&nbsp;<em>et al.</em>, ICLR 2022]</figcaption>
</figure>
</div>
<p><span class="math display">\[
  \mathscr{L}_{aug} = \mathscr{L}(W_{base}) + \alpha \mathscr{L}([W_{base}, W_{aug}])
  \]</span></p>
<ul>
<li><span class="math inline">\(\mathscr{L}_{aug}\)</span> = base supervision + <span class="math inline">\(\alpha \cdot\)</span>auxiliary supervision</li>
</ul></li>
<li><p>Learning Curve</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 25.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Network Augmentation for Tiny Deep Learning [Cai&nbsp;<em>et al.</em>, ICLR 2022]</figcaption>
</figure>
</div></li>
<li><p>Result</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 26.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Network Augmentation for Tiny Deep Learning [Cai&nbsp;<em>et al.</em>, ICLR 2022]</figcaption>
</figure>
</div></li>
<li><p>Result for Transfer Learning</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../images/lec09/Untitled 27.png" class="img-fluid figure-img"></p>
<figcaption>Reference. Network Augmentation for Tiny Deep Learning [Cai&nbsp;<em>et al.</em>, ICLR 2022]</figcaption>
</figure>
</div></li>
</ul>
<p>ÏßÄÍ∏àÍπåÏßÄ Knowledge DistilationÏùò Í∏∞Î≤ïÎì§ Í∑∏Î¶¨Í≥† Ïù¥Î•º Ïù¥Ïö©Ìïú AppllcationÏóê ÎåÄÌï¥ÏÑú Îã§Î§ÑÎ¥§ÏäµÎãàÎã§. Îã§Ïùå ÏãúÍ∞ÑÏóêÎäî TinyEngineÏùÑ ÏúÑÌïú ÏµúÏ†ÅÌôî Í∏∞Î≤ïÏúºÎ°ú Îã§Ïãú Ï∞æÏïÑÏò¨Í≤åÏöî üôÇ</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="TINYML-KOR/blog" data-repo-id="R_kgDOLC9iGA" data-category="General" data-category-id="DIC_kwDOLC9iGM4Cc7eP" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->




</body></html>